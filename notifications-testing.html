<html>
<head></head>
<body>
<h1 onclick="solicitarPermisoNotificaciones();">Solicitar Permiso de Notificaciones</h1>
<input id="urlInput" type="url" placeholder="Inserta URL">
<h1 onclick="enviarNotificacion();">Enviar Notificación</h1>

<script>
// Registro del service worker
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js').then(function(registration) {
    console.log('Service Worker registrado con éxito:', registration);
  }).catch(function(error) {
    console.log('Error al registrar el Service Worker:', error);
  });
}

// Solicitar permiso para notificaciones
function solicitarPermisoNotificaciones() {
  Notification.requestPermission().then(function(result) {
    if (result === 'granted') {
      console.log('Permiso para notificaciones concedido');
    } else if (result === 'denied') {
        console.log('Permiso para notificaciones denegado');
    } else {
        console.log('Permiso para notificaciones no decidido');
    }
  });
}

// Enviar una notificación
function enviarNotificacion() {
  let newUrl = document.getElementById('urlInput').value;
  console.log(newUrl);
  if (Notification.permission === 'granted') {
    navigator.serviceWorker.getRegistration().then(function(reg) {
      reg.showNotification('Título de la Notificación', {
        body: 'Este es el cuerpo de la notificación',
        icon: 'https://casanarino.presidencia.gov.co/img/hero.png',
        badge: 'yamil-favicon.png',
        image: 'https://casanarino.presidencia.gov.co/img/hero.png',
        data: { url : newUrl }
      });
    });
  }
  else {
    console.log('¿Ya concediste el permiso para notificaciones?')
  }
}
</script>
</body>
</html>
